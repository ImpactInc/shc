/*
 * This file was generated by the Gradle 'init' task.
 */

apply from: "$rootDir/gradle/test.gradle"
apply from: "$rootDir/gradle/jar.gradle"


group = "com.impact.scoring"
customArtifactId = "shc-core-1.12.0-2.4.7-s_2.12"

configurations {
    compileAndJar
    compile { extendsFrom compileAndJar }
    lib
}

dependencies {
    implementation 'org.apache.spark:spark-core_2.12:2.4.7'
    implementation 'org.apache.spark:spark-catalyst_2.12:2.4.7'
    implementation 'org.apache.spark:spark-sql_2.12:2.4.7'
    implementation('org.apache.hbase:hbase-server') {
        version {
            strictly "$hbaseVer"
        }
        exclude group: "org.jboss.netty", module: "netty"
        exclude group: 'asm', module: 'asm'
        exclude group: 'commons-logging', module: 'commons-logging'
        exclude group: 'org.jruby', module: 'jruby-complete'
    }
    implementation('org.apache.hbase:hbase-common') {
        version {
            strictly "$hbaseVer"
        }
        exclude group: 'org.jboss.netty', module: 'netty'
        exclude group: 'asm', module: 'asm'
        exclude group: 'commons-logging', module: 'commons-logging'
        exclude group: 'org.jruby', module: 'jruby-complete'
    }
    implementation('org.apache.hadoop:hadoop-hdfs') {
        version {
            strictly '3.0.0'
        }
    }
    implementation('com.fasterxml.jackson.core:jackson-databind') {
        version {
            strictly '2.6.7.3'
        }
    }
    testImplementation('org.apache.hbase:hbase-testing-util') {
        version {
            strictly "$hbaseVer"
        }
    }
    implementation('org.apache.phoenix:phoenix-core:5.0.0-HBase-2.0') {
        exclude group: 'org.apache.omid', module: 'omid-hbase-client-hbase2.x'
        exclude group: 'org.apache.omid', module: 'omid-hbase-coprocessor-hbase2.x'
        exclude group: 'org.apache.omid', module: 'omid-tso-server-hbase2.x'
        exclude group: 'org.apache.omid', module: 'omid-hbase-common-hbase2.x'
        exclude group: 'org.apache.omid', module: 'omid-timestamp-storage-hbase2.x'
        exclude group: 'org.apache.omid', module: 'omid-hbase-commit-table-hbase2.x'
    }
    implementation 'org.apache.avro:avro:1.8.2'
    implementation 'com.google.cloud.bigtable:bigtable-hbase-2.x-hadoop:1.12.0'
    testImplementation 'org.scalatest:scalatest_2.12:3.0.5'
}

task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = "sources"
    from(sourceSets.main.allSource)
    from(project.sourceSets.main.allSource)
}

apply plugin: "maven-publish"

publishing {
    publications {
        mavenJava(MavenPublication) {
            artifactId = customArtifactId
            artifact jar
            artifact sourcesJar
        }
    }
    repositories {
        maven {
            url "https://ir-nexus.impactradius.net/repository/snapshots/"
            credentials {
                username findProperty("nexusUsername")
                password findProperty("nexusPassword")
            }
        }
    }
}

oneJar(project, "compileAndJar")

description = 'HBase Spark Connector Project Core'
